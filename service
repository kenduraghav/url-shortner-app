#!/bin/bash

# Config
APP_NAME=url-shortner-app
IMAGE_NAME=kenduraghav/url-shortner-app  # Replace with your Docker Hub username
DOCKERFILE_PATH=./Dockerfile
COMPOSE_FILE=./docker/docker-compose.yml

# Functions
deploy() {
  echo "üì¶ Building Docker image..."
  docker build -t $IMAGE_NAME -f $DOCKERFILE_PATH .

  echo "üöÄ Pushing Docker image to registry..."
  docker push $IMAGE_NAME

  echo "üß± Starting services with Docker Compose..."
  docker-compose -f $COMPOSE_FILE up -d

  echo "‚úÖ Deployment complete!"
}

stop() {
  echo "‚è∏Ô∏è Stopping containers..."
  docker-compose -f $COMPOSE_FILE stop
  echo "‚úÖ Containers stopped."
}

start() {
  echo "‚ñ∂Ô∏è Starting containers..."
  docker-compose -f $COMPOSE_FILE start
  echo "‚úÖ Containers started."
}

# Entrypoint
case "$1" in
  deploy) deploy ;;
  stop) stop ;;
  start) start ;;
  *)
    echo "‚ùå Invalid command: $1"
    echo "Usage: $0 {deploy|stop|start}"
    exit 1
    ;;
esac
